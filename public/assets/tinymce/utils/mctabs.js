/**
 * mctabs.js
 *
 * Copyright 2009, Moxiecode Systems AB
 * Released under LGPL License.
 *
 * License: http://tinymce.moxiecode.com/license
 * Contributing: http://tinymce.moxiecode.com/contributing
 */
function MCTabs(){this.settings=[],this.onChange=tinyMCEPopup.editor.windowManager.createInstance("tinymce.util.Dispatcher")}MCTabs.prototype.init=function(a){this.settings=a},MCTabs.prototype.getParam=function(a,b){var c=null;return c=typeof this.settings[a]=="undefined"?b:this.settings[a],c=="true"||c=="false"?c=="true":c},MCTabs.prototype.showTab=function(a){a.className="current",a.setAttribute("aria-selected",!0),a.setAttribute("aria-expanded",!0),a.tabIndex=0},MCTabs.prototype.hideTab=function(a){var b=this;a.className="",a.setAttribute("aria-selected",!1),a.setAttribute("aria-expanded",!1),a.tabIndex=-1},MCTabs.prototype.showPanel=function(a){a.className="current",a.setAttribute("aria-hidden",!1)},MCTabs.prototype.hidePanel=function(a){a.className="panel",a.setAttribute("aria-hidden",!0)},MCTabs.prototype.getPanelForTab=function(a){return tinyMCEPopup.dom.getAttrib(a,"aria-controls")},MCTabs.prototype.displayTab=function(a,b,c){var d,e,f,g,h,i,j,k=this;f=document.getElementById(a),b===undefined&&(b=k.getPanelForTab(f)),d=document.getElementById(b),e=d?d.parentNode:null,g=f?f.parentNode:null,h=k.getParam("selection_class","current");if(f&&g){i=g.childNodes;for(j=0;j<i.length;j++)i[j].nodeName=="LI"&&k.hideTab(i[j]);k.showTab(f)}if(d&&e){i=e.childNodes;for(j=0;j<i.length;j++)i[j].nodeName=="DIV"&&k.hidePanel(i[j]);c||f.focus(),k.showPanel(d)}},MCTabs.prototype.getAnchor=function(){var a,b=document.location.href;return(a=b.lastIndexOf("#"))!=-1?b.substring(a+1):""};var mcTabs=new MCTabs;tinyMCEPopup.onInit.add(function(){var a=tinyMCEPopup.getWin().tinymce,b=tinyMCEPopup.dom,c=a.each;c(b.select("div.tabs"),function(d){var e;b.setAttrib(d,"role","tablist");var f=tinyMCEPopup.dom.select("li",d),g=function(a){mcTabs.displayTab(a,mcTabs.getPanelForTab(a)),mcTabs.onChange.dispatch(a)};c(f,function(a){b.setAttrib(a,"role","tab"),b.bind(a,"click",function(b){g(a.id)})}),b.bind(b.getRoot(),"keydown",function(b){b.keyCode===9&&b.ctrlKey&&!b.altKey&&(e.moveFocus(b.shiftKey?-1:1),a.dom.Event.cancel(b))}),c(b.select("a",d),function(a){b.setAttrib(a,"tabindex","-1")}),e=tinyMCEPopup.editor.windowManager.createInstance("tinymce.ui.KeyboardNavigation",{root:d,items:f,onAction:g,actOnFocus:!0,enableLeftRight:!0,enableUpDown:!0},tinyMCEPopup.dom)})});