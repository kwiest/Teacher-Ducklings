function init(){tinyMCEPopup.resizeToInnerSize(),document.getElementById("backgroundimagebrowsercontainer").innerHTML=getBrowserHTML("backgroundimagebrowser","backgroundimage","image","table"),document.getElementById("bgcolor_pickcontainer").innerHTML=getColorPickerHTML("bgcolor_pick","bgcolor");var a=tinyMCEPopup.editor,b=a.dom,c=b.getParent(a.selection.getStart(),"tr"),d=document.forms[0],e=b.parseStyle(b.getAttrib(c,"style")),f=c.parentNode.nodeName.toLowerCase(),g=b.getAttrib(c,"align"),h=b.getAttrib(c,"valign"),i=trimSize(getStyle(c,"height","height")),j=b.getAttrib(c,"class"),k=convertRGBToHex(getStyle(c,"bgcolor","backgroundColor")),l=getStyle(c,"background","backgroundImage").replace(new RegExp("url\\(['\"]?([^'\"]*)['\"]?\\)","gi"),"$1"),m=b.getAttrib(c,"id"),n=b.getAttrib(c,"lang"),o=b.getAttrib(c,"dir");selectByValue(d,"rowtype",f),b.select("td.mceSelected,th.mceSelected",c).length==0?(addClassesToList("class","table_row_styles"),TinyMCE_EditableSelects.init(),d.bgcolor.value=k,d.backgroundimage.value=l,d.height.value=i,d.id.value=m,d.lang.value=n,d.style.value=b.serializeStyle(e),selectByValue(d,"align",g),selectByValue(d,"valign",h),selectByValue(d,"class",j,!0,!0),selectByValue(d,"dir",o),isVisible("backgroundimagebrowser")&&(document.getElementById("backgroundimage").style.width="180px"),updateColor("bgcolor_pick","bgcolor")):tinyMCEPopup.dom.hide("action")}function updateAction(){var a=tinyMCEPopup.editor,b=a.dom,c,d,e=document.forms[0],f=getSelectValue(e,"action");if(!AutoValidator.validate(e))return tinyMCEPopup.alert(AutoValidator.getErrorMessages(e).join(". ")+"."),!1;tinyMCEPopup.restoreSelection(),c=b.getParent(a.selection.getStart(),"tr"),d=b.getParent(a.selection.getStart(),"table");if(b.select("td.mceSelected,th.mceSelected",c).length>0){tinymce.each(d.rows,function(a){var c;for(c=0;c<a.cells.length;c++)if(b.hasClass(a.cells[c],"mceSelected")){updateRow(a,!0);return}}),a.addVisual(),a.nodeChanged(),a.execCommand("mceEndUndoLevel"),tinyMCEPopup.close();return}switch(f){case"row":updateRow(c);break;case"all":var g=d.getElementsByTagName("tr");for(var h=0;h<g.length;h++)updateRow(g[h],!0);break;case"odd":case"even":var g=d.getElementsByTagName("tr");for(var h=0;h<g.length;h++)(h%2==0&&f=="odd"||h%2!=0&&f=="even")&&updateRow(g[h],!0,!0)}a.addVisual(),a.nodeChanged(),a.execCommand("mceEndUndoLevel"),tinyMCEPopup.close()}function updateRow(a,b,c){var d=tinyMCEPopup.editor,e=document.forms[0],f=d.dom,g=a.parentNode.nodeName.toLowerCase(),h=getSelectValue(e,"rowtype"),i=d.getDoc();b||f.setAttrib(a,"id",e.id.value),f.setAttrib(a,"align",getSelectValue(e,"align")),f.setAttrib(a,"vAlign",getSelectValue(e,"valign")),f.setAttrib(a,"lang",e.lang.value),f.setAttrib(a,"dir",getSelectValue(e,"dir")),f.setAttrib(a,"style",f.serializeStyle(f.parseStyle(e.style.value))),f.setAttrib(a,"class",getSelectValue(e,"class")),f.setAttrib(a,"background",""),f.setAttrib(a,"bgColor",""),f.setAttrib(a,"height",""),a.style.height=getCSSSize(e.height.value),a.style.backgroundColor=e.bgcolor.value,e.backgroundimage.value!=""?a.style.backgroundImage="url('"+e.backgroundimage.value+"')":a.style.backgroundImage="";if(g!=h&&!c){var j=a.cloneNode(1),k=f.getParent(a,"table"),l=h,m=null;for(var n=0;n<k.childNodes.length;n++)k.childNodes[n].nodeName.toLowerCase()==l&&(m=k.childNodes[n]);m==null&&(m=i.createElement(l),k.firstChild.nodeName=="CAPTION"?d.dom.insertAfter(m,k.firstChild):k.insertBefore(m,k.firstChild)),m.appendChild(j),a.parentNode.removeChild(a),a=j}f.setAttrib(a,"style",f.serializeStyle(f.parseStyle(a.style.cssText)))}function changedBackgroundImage(){var a=document.forms[0],b=tinyMCEPopup.editor.dom,c=b.parseStyle(a.style.value);c["background-image"]="url('"+a.backgroundimage.value+"')",a.style.value=b.serializeStyle(c)}function changedStyle(){var a=document.forms[0],b=tinyMCEPopup.editor.dom,c=b.parseStyle(a.style.value);c["background-image"]?a.backgroundimage.value=c["background-image"].replace(new RegExp("url\\('?([^']*)'?\\)","gi"),"$1"):a.backgroundimage.value="",c.height&&(a.height.value=trimSize(c.height)),c["background-color"]&&(a.bgcolor.value=c["background-color"],updateColor("bgcolor_pick","bgcolor"))}function changedSize(){var a=document.forms[0],b=tinyMCEPopup.editor.dom,c=b.parseStyle(a.style.value),d=a.height.value;d!=""?c.height=getCSSSize(d):c.height="",a.style.value=b.serializeStyle(c)}function changedColor(){var a=document.forms[0],b=tinyMCEPopup.editor.dom,c=b.parseStyle(a.style.value);c["background-color"]=a.bgcolor.value,a.style.value=b.serializeStyle(c)}tinyMCEPopup.requireLangPack(),tinyMCEPopup.onInit.add(init);